---
title: "STA 141A- Project 2"
author: "Eshna Prakash"
date: "2/20/2021"
output: html_document
---

```{r setup, include=FALSE}
library(dplyr)
library(ggplot2)
```
#Abstract 

#Introduction

#Background 

#Descriptive Analysis 
```{r}
#WHO Data Set 
covid <- read.csv("https://covid19.who.int/WHO-COVID-19-global-data.csv")
names(covid) 

#Merged Data of Policy and CFR calculation 
final<- read.csv("C:/Users/eshna/Downloads/final_data.csv")

#Nigeria
nigeria=filter(final,(Country=="Nigeria"))
nigeria=nigeria[89:188,]
nigeria=mutate(nigeria,time=seq(1:100))
par(mfrow=c(2,2))
plot(nigeria$time, nigeria$New_cases, main="Plot of New Cases over time for Nigeria", xlab = "Time (in days)", ylab = "New Cases")
#In this plot we see a somewhat negative linear trend of new cases over time. 
plot(nigeria$time, nigeria$New_deaths, main="Plot of New Deaths over time for Nigeria",xlab = "Time (in days)", ylab = "New Deaths")
#In this plot there seems to be one data point that appears to be an outlier while the daily number of new deaths tends to stay below 20. 

#Ethiopia
ethiopia=filter(final,(Country=="Ethiopia"))
ethiopia=ethiopia[8:107,]
ethiopia=mutate(ethiopia,time=seq(1:100))
par(mfrow=c(2,2))
plot(ethiopia$time, ethiopia$New_cases, main="Plot of New Cases over time for Ethiopia", xlab = "Time (in days)", ylab = "New Cases")
#In this plot we see a positive trend of new cases as time increases.  It does not appear to be linear.
plot(ethiopia$time, ethiopia$New_deaths, main="Plot of New Deaths over time for Ethiopia",xlab = "Time (in days)", ylab = "New Deaths")
#In this plot, it appears to have a positive trend of new deaths as time increases. 

#US
usa=filter(final,(Country=="United States"))
usa=usa[61:160,]
usa=mutate(usa,time=seq(1:100))
par(mfrow=c(2,2))
plot(usa$time, usa$New_cases, main="Plot of New Cases over time for USA", xlab = "Time (in days)", ylab = "New Cases")
#In this plot, there is a positive trend in new cases as time increases, especially after approximately the 50th day after the 100th positive case. It does not appear to be linear.
plot(usa$time, usa$New_deaths, main="Plot of New Deaths over time for USA",xlab = "Time (in days)", ylab = "New Deaths")
#In this plot, the number of new deaths appears to have less variability after the first 10 days and it does not seem like there is a linear relationship present.



#Brazil
brazil=filter(final,(Country=="Brazil"))
brazil=brazil[71:170,]
brazil=mutate(brazil,time=seq(1:100))
par(mfrow=c(2,2))
plot(brazil$time, brazil$New_cases, main="Plot of New Cases over time for Brazil", xlab = "Time (in days)", ylab = "New Cases")
#In this plot, there is a positive trend in new cases as time increases that appears to be somewhat linear. There is more variability in the number of new cases as time progresses.
plot(brazil$time, brazil$New_deaths, main="Plot of New Deaths over time for Brazil",xlab = "Time (in days)", ylab = "New Deaths")
#In this plot, there appears to be no trend or linear relationship present between the new death numbers and days.


#India
india=filter(final,(Country=="India"))
india=india[73:172,]
india=mutate(india,time=seq(1:100))
par(mfrow=c(2,2))
plot(india$time, india$New_cases, main="Plot of New Cases over time for India", xlab = "Time (in days)", ylab = "New Cases")
#In this plot, there is a positive trend. It visually appears to be linear.
plot(india$time, india$New_deaths, main="Plot of New Deaths over time for India",xlab = "Time (in days)", ylab = "New Deaths")
#In this plot, there appears to be a positive linear trend with a few possible present. 


#Indonesia
indonesia=filter(final,(Country=="Indonesia"))
indonesia=indonesia[73:172,]
indonesia=mutate(indonesia,time=seq(1:100))
par(mfrow=c(2,2))
plot(indonesia$time, indonesia$New_cases, main="Plot of New Cases over time for Indonesia", xlab = "Time (in days)", ylab = "New Cases")
#In this plot there appears to be a positive linear trend. 
plot(indonesia$time, indonesia$New_deaths, main="Plot of New Deaths over time for Indonesia", xlab = "Time (in days)", ylab = "New Deaths")
#In this plot there appears to be a slight positive linear trend with a few possible outliers. 



#Russia
russia=filter(final,(Country=="Russia"))
russia=russia[77:176,]
russia=mutate(russia,time=seq(1:100))
par(mfrow=c(2,2))
plot(russia$time, russia$New_cases, main="Plot of New Cases over time for Russia", xlab = "Time (in days)", ylab = "New Cases")
#In this plot we see a somewhat negative linear trend of new cases over time. 
plot(russia$time, russia$New_deaths, main="Plot of New Deaths over time for Russia", xlab = "Time (in days)", ylab = "New Deaths")
#In this plot there is no obvious pattern or linear trend.


#Turkey
turkey=filter(final,(Country=="Turkey"))
turkey=turkey[77:176,]
turkey=mutate(turkey,time=seq(1:100))
par(mfrow=c(2,2))
plot(turkey$time, turkey$New_cases, main="Plot of New Cases over time for Turkey", xlab = "Time (in days)", ylab = "New Cases")
#In this plot there is a clear nonlinear trend. There is a clear jump around day 70 where cases increase. 
plot(turkey$time, turkey$New_deaths, main="Plot of New Deaths over time for Turkey", xlab = "Time (in days)", ylab = "New Deaths")
#There is a clear nonlinear trend. 


#Pakistan
pakistan=filter(final,(Country=="Pakistan"))
pakistan=pakistan[75:174,]
pakistan=mutate(pakistan,time=seq(1:100))
par(mfrow=c(2,2))
plot(pakistan$time, pakistan$New_cases, main="Plot of New Cases over time for Pakistan", xlab = "Time (in days)", ylab = "New Cases")
#In this plot, it is evident that there is not a linear trend and is unimodal. 
plot(pakistan$time, pakistan$New_deaths, main="Plot of New Deaths over time for Pakistan", xlab = "Time (in days)", ylab = "New Deaths")
#In this plot, it is evident that there is not a linear trend. 


#Egypt
egypt=filter(final,(Country=="Egypt"))
egypt=egypt[73:172,]
egypt=mutate(egypt,time=seq(1:100))
par(mfrow=c(2,2))
plot(egypt$time, egypt$New_cases, main="Plot of New Cases over time for Egypt", xlab = "Time (in days)", ylab = "New Cases")
#In this plot, it is evident that there is not a linear trend.
plot(egypt$time, egypt$New_deaths, main="Plot of New Deaths over time for Egypt", xlab = "Time (in days)", ylab = "New Deaths")
#In this plot, it is evident that there is not a linear trend.


#China 
china=filter(final,(Country=="China"))
china=china[17:116,]
china=mutate(china,time=seq(1:100))
par(mfrow=c(2,2))
plot(china$time, china$New_cases, main="Plot of New Cases over time for China", xlab = "Time (in days)", ylab = "New Cases")
#In this plot, it appears that there may be an outlier present. There is no clear trend present. 
plot(china$time, china$New_deaths, main="Plot of New Deaths over time for China", xlab = "Time (in days)", ylab = "New Deaths")
#In this plot there is one evident outlier with a constant level of deaths below 200. 


#Japan
japan=filter(final,(Country=="Japan"))
japan=japan[50:149,]
japan=mutate(japan,time=seq(1:100))
par(mfrow=c(2,2))
plot(japan$time, japan$New_cases, main="Plot of New Cases over time for Japan", xlab = "Time (in days)", ylab = "New Cases")
#In this plot, we can see a clear non linear trend of new cases over time. 
plot(japan$time, japan$New_deaths, main="Plot of New Deaths over time for Japan", xlab = "Time (in days)", ylab = "New Deaths")
#In this plot, it appears that there may be an outlier present. There is a somewhat negative trend. 

#We want to look at CFR in our analysis to estimate the proportion of deaths among identified confirmed cases
#CFR= CFR= all deaths/ all cases 
nigeriaCFR= nigeria$Cumulative_deaths/nigeria$Cumulative_cases
plot(nigeriaCFR, main="Plot of Nigeria CFR")
#This plot has a negative linear trend.

ethiopiaCFR= ethiopia$Cumulative_deaths/ethiopia$Cumulative_cases
plot(ethiopiaCFR, main="Plot of Ethiopia CFR")
#This plot has does not have a clear pattern.

usaCFR= usa$Cumulative_deaths/usa$Cumulative_cases
plot(usaCFR, main="Plot of USA CFR")
#This plot had a negative non-linear trend.

brazilCFR= brazil$Cumulative_deaths/brazil$Cumulative_cases
plot(brazilCFR, main="Plot of Brazil CFR")
#This plot has a negative linear trend 

indiaCFR= india$Cumulative_deaths/india$Cumulative_cases
plot(indiaCFR, main="Plot of India CFR")
#This plot does not have a clear trend.

indonesiaCFR= indonesia$Cumulative_deaths/indonesia$Cumulative_cases
plot(indonesiaCFR, main="Plot of Indonesia CFR")
#This plot has a negative linear trend

russiaCFR= russia$Cumulative_deaths/russia$Cumulative_cases
plot(russiaCFR, main="Plot of Russia CFR")
#

turkeyCFR= turkey$Cumulative_deaths/turkey$Cumulative_cases
plot(turkeyCFR, main="Plot of Turkey CFR")
#This plot has a negative non-linear trend

pakistanCFR= pakistan$Cumulative_deaths/pakistan$Cumulative_cases
plot(pakistanCFR, main="Plot of Pakistan CFR")
#This plot does not have a clear trend

egyptCFR= egypt$Cumulative_deaths/egypt$Cumulative_cases
plot(egyptCFR, main="Plot of Egypt CFR")
#This plot does not have a clear trend

chinaCFR= china$Cumulative_deaths/china$Cumulative_cases
plot(chinaCFR, main="Plot of China CFR")
#This plot does not have a clear trend

japanCFR= japan$Cumulative_deaths/japan$Cumulative_cases
plot(japanCFR, main="Plot of Japan CFR")
#This plot has a non-linear trend.

```
